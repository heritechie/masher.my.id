---
import Layout from '../layouts/Layout.astro';
import { SUPPORTED_LOCALES, translations, defaultLocale, type Locale } from '../i18n/translations';

const { locale } = Astro.props as { locale: Locale };
const t = translations[locale];

const languageLinks = SUPPORTED_LOCALES.map((code) => ({
	lang: code,
	label: t.layout.languageNames[code],
	href: code === defaultLocale ? '/knowledge-base/' : `/${code}/knowledge-base/`,
	active: code === locale,
}));

const localePrefix = locale === defaultLocale ? '' : `/${locale}`;
const journalLink = locale === defaultLocale ? '/jurnal/' : `/${locale}/journal/`;

const navLinks = [
	{
		label: t.layout.learningJourneyLabel,
		href: journalLink,
		active: false,
	},
	{
		label: t.layout.knowledgeBaseLabel,
		href: locale === defaultLocale ? '/knowledge-base/' : `/${locale}/knowledge-base/`,
		active: true,
	},
	{
		label: t.layout.webtoolsLabel,
		href: locale === defaultLocale ? '/webtools/' : `/${locale}/webtools/`,
		active: false,
	},
];

const glossary = t.knowledgeBase.glossary;
const homeHref = locale === defaultLocale ? '/' : `/${locale}/`;
---

<Layout
	title={t.knowledgeBase.meta.title}
	description={t.knowledgeBase.meta.description}
	brand={t.layout.brand}
	tagline={t.layout.tagline}
	locale={locale}
	languageLinks={languageLinks}
	navLinks={navLinks}
	navLabel={t.layout.primaryNavLabel}
	mobileMenuLabel={t.layout.mobileMenuLabel}
	switcherLabel={t.layout.languageSwitcherLabel}
	themeToggleLabel={t.layout.themeToggleLabel}
>

	<section class="kb-glossary">
		{glossary.map((section) => (
			<article class="kb-section">
				<header class="kb-section__header">
					<h2>{section.category}</h2>
					<p>{section.description}</p>
				</header>
				<dl class="kb-terms">
					{section.items.map((item) => (
						<div class="kb-term">
							<dt>{item.term}</dt>
							<dd>{item.summary}</dd>
							{item.notes ? <p class="kb-term__note">{item.notes}</p> : null}
						</div>
					))}
				</dl>
			</article>
		))}
	</section>

	<section class="kb-footnote" aria-label={t.knowledgeBase.comingSoonLabel}>
		<i class="ri-flashlight-line" aria-hidden="true"></i>
		<p>{t.knowledgeBase.comingSoonLabel}</p>
	</section>
</Layout>

<style>
	.kb-hero {
		display: grid;
		gap: 20px;
		padding: 36px;
		border-radius: 28px;
		background:
			linear-gradient(160deg, rgba(210, 210, 207, 0.18), transparent 60%),
			var(--surface-card);
		border: 1px solid var(--glass-stroke);
		box-shadow: var(--shadow-soft);
		backdrop-filter: blur(22px);
	}

	.kb-hero__content {
		display: grid;
		gap: 18px;
	}

	.kb-hero__eyebrow {
		display: inline-flex;
		align-items: center;
		gap: 8px;
		padding: 6px 14px;
		border-radius: 999px;
		border: 1px solid var(--glass-stroke);
		background: var(--surface-highlight);
		color: var(--text-muted);
		font-size: 0.82rem;
		text-transform: uppercase;
		letter-spacing: 0.14em;
	}

	h1 {
		margin: 0;
		font-family: var(--font-display);
		font-size: clamp(2.3rem, 5vw, 3.3rem);
	}

	.kb-hero__intro {
		margin: 0;
		color: var(--text-muted);
		font-size: 1.08rem;
		max-width: 72ch;
	}

	.kb-hero__note {
		display: inline-flex;
		align-items: flex-start;
		gap: 10px;
		margin: 0;
		padding: 10px 18px;
		border-radius: 18px;
		background: var(--surface-highlight);
		border: 1px solid var(--glass-stroke);
		color: var(--text-main);
		font-size: 0.95rem;
		max-width: 70ch;
	}

	.kb-hero__note i {
		margin-top: 2px;
	}

	.kb-hero__back {
		display: inline-flex;
		align-items: center;
		gap: 8px;
		padding: 10px 18px;
		border-radius: 999px;
		color: var(--accent);
		font-weight: 600;
		font-size: 0.92rem;
		letter-spacing: 0.04em;
		width: fit-content;
		transition: transform 0.2s ease, color 0.2s ease;
	}

	.kb-hero__back:hover {
		transform: translateX(-4px);
		color: var(--accent-strong);
	}

	.kb-glossary {
		display: grid;
		gap: 24px;
	}

	.kb-section {
		display: grid;
		gap: 18px;
		padding: 28px;
		border-radius: 24px;
		background: var(--surface-card);
		border: 1px solid var(--glass-stroke);
		box-shadow: var(--shadow-soft);
	}

	.kb-section__header {
		display: grid;
		gap: 10px;
	}

	.kb-section__header h2 {
		margin: 0;
		font-family: var(--font-display);
		font-size: clamp(1.8rem, 3.5vw, 2.4rem);
	}

	.kb-section__header p {
		margin: 0;
		color: var(--text-muted);
		max-width: 65ch;
	}

	.kb-terms {
		display: grid;
		gap: 16px;
		margin: 0;
	}

	.kb-term {
		display: grid;
		gap: 8px;
		padding: 18px;
		border-radius: 18px;
		border: 1px solid var(--glass-stroke);
		background:
			linear-gradient(160deg, rgba(210, 210, 207, 0.12), transparent 70%),
			var(--surface-panel);
	}

	.kb-term dt {
		margin: 0;
		font-weight: 700;
		font-size: 1.08rem;
		color: var(--text-main);
	}

	.kb-term dd {
		margin: 0;
		color: var(--text-muted);
		line-height: 1.6;
	}

	.kb-term__note {
		margin: 0;
		color: var(--text-subtle);
		font-size: 0.9rem;
	}

	.kb-footnote {
		display: inline-flex;
		align-items: center;
		gap: 10px;
		padding: 12px 20px;
		border-radius: 999px;
		background: var(--surface-highlight);
		border: 1px solid var(--glass-stroke);
		color: var(--text-muted);
		font-size: 0.92rem;
	}

	@media (max-width: 768px) {
		.kb-hero,
		.kb-section {
			padding: 24px;
		}

		.kb-hero__intro,
		.kb-hero__note {
			font-size: 1rem;
		}

		.kb-term {
			padding: 16px;
		}
	}
</style>
