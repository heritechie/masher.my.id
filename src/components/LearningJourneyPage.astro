---
import Layout from '../layouts/Layout.astro';
import { SUPPORTED_LOCALES, translations, defaultLocale, type Locale } from '../i18n/translations';

const { locale } = Astro.props as { locale: Locale };
const t = translations[locale];

const languageLinks = SUPPORTED_LOCALES.map((code) => ({
	lang: code,
	label: t.layout.languageNames[code],
	href: code === defaultLocale ? '/learning-journey/' : `/${code}/learning-journey/`,
	active: code === locale,
}));

const localePrefix = locale === defaultLocale ? '' : `/${locale}`;

const navLinks = [
	{
		label: t.layout.learningJourneyLabel,
		href: `${localePrefix}/learning-journey/`,
		active: true,
	},
	{
		label: t.layout.knowledgeBaseLabel,
		href: `${localePrefix}/knowledge-base/`,
		active: false,
	},
	{
		label: t.layout.webtoolsLabel,
		href: `${localePrefix}/webtools/`,
		active: false,
	},
];

const entries = t.learningJourney.articles;
const homeHref = locale === defaultLocale ? '/' : `/${locale}/`;
---

<Layout
	title={t.learningJourney.meta.title}
	description={t.learningJourney.meta.description}
	brand={t.layout.brand}
	tagline={t.layout.tagline}
	locale={locale}
	languageLinks={languageLinks}
	navLinks={navLinks}
	navLabel={t.layout.primaryNavLabel}
	mobileMenuLabel={t.layout.mobileMenuLabel}
	switcherLabel={t.layout.languageSwitcherLabel}
	themeToggleLabel={t.layout.themeToggleLabel}
>
	<section class="journey-hero">
		<header class="journey-hero__content">
			<span class="journey-hero__eyebrow">
				<i class="ri-compass-discover-line" aria-hidden="true"></i>
				{t.learningJourney.title}
			</span>
			<h1>{t.learningJourney.title}</h1>
			<p class="journey-hero__intro">{t.learningJourney.intro}</p>
		</header>
		<a class="journey-hero__back" href={homeHref}>
			<i class="ri-arrow-go-back-line" aria-hidden="true"></i>
			{t.learningJourney.backLabel}
		</a>
	</section>

	<section class="journey-timeline" aria-label={t.learningJourney.timelineLabel}>
		<div class="journey-timeline__header">
			<h2>
				<i class="ri-road-map-line" aria-hidden="true"></i>
				{t.learningJourney.timelineLabel}
			</h2>
			<p>{t.learningJourney.meta.description}</p>
		</div>

		<div class="journey-grid">
			{entries.map((entry) => {
				const hasLink = Boolean(entry.link);
				const href = entry.link ?? undefined;
				const isExternal = hasLink && typeof href === 'string' && href.startsWith('http');
				return (
					<article class="journey-card">
						<span class="journey-card__year">{entry.year}</span>
						<h3>{entry.title}</h3>
						<p class="journey-card__summary">{entry.summary}</p>
						<ul class="journey-card__topics">
							{entry.topics.map((topic) => (
								<li>{topic}</li>
							))}
						</ul>
						{hasLink && href ? (
							<a
								class="journey-card__cta"
								href={href}
								target={isExternal ? '_blank' : undefined}
								rel={isExternal ? 'noopener noreferrer' : undefined}
							>
								<span>{t.learningJourney.readLabel}</span>
								<i class="ri-arrow-right-up-line" aria-hidden="true"></i>
							</a>
						) : (
							<span class="journey-card__placeholder">
								<i class="ri-hourglass-line" aria-hidden="true"></i>
								{t.learningJourney.upcomingLabel}
							</span>
						)}
					</article>
				);
			})}
		</div>
	</section>
</Layout>

<style>
	.journey-hero {
		display: grid;
		gap: 20px;
		padding: 36px;
		border-radius: 28px;
		background:
			linear-gradient(160deg, rgba(210, 210, 207, 0.18), transparent 65%),
			var(--surface-card);
		border: 1px solid var(--glass-stroke);
		box-shadow: var(--shadow-soft);
		backdrop-filter: blur(22px);
	}

	.journey-hero__content {
		display: grid;
		gap: 18px;
	}

	.journey-hero__eyebrow {
		display: inline-flex;
		align-items: center;
		gap: 8px;
		padding: 6px 14px;
		border-radius: 999px;
		border: 1px solid var(--glass-stroke);
		background: var(--surface-highlight);
		color: var(--text-muted);
		font-size: 0.82rem;
		text-transform: uppercase;
		letter-spacing: 0.14em;
	}

	h1 {
		margin: 0;
		font-family: var(--font-display);
		font-size: clamp(2.2rem, 5vw, 3.2rem);
	}

	.journey-hero__intro {
		margin: 0;
		color: var(--text-muted);
		font-size: 1.08rem;
		max-width: 70ch;
	}

	.journey-hero__back {
		display: inline-flex;
		align-items: center;
		justify-content: flex-start;
		gap: 8px;
		padding: 10px 18px;
		border-radius: 999px;
		color: var(--accent);
		font-weight: 600;
		font-size: 0.92rem;
		letter-spacing: 0.04em;
		width: fit-content;
		transition: transform 0.2s ease, color 0.2s ease;
	}

	.journey-hero__back:hover {
		transform: translateX(-4px);
		color: var(--accent-strong);
	}

	.journey-timeline {
		display: grid;
		gap: 24px;
	}

	.journey-timeline__header {
		display: grid;
		gap: 12px;
	}

	.journey-timeline__header h2 {
		display: inline-flex;
		align-items: center;
		gap: 10px;
		margin: 0;
		font-family: var(--font-display);
		font-size: clamp(1.8rem, 3.5vw, 2.4rem);
	}

	.journey-timeline__header p {
		margin: 0;
		color: var(--text-muted);
		max-width: 65ch;
	}

	.journey-grid {
		display: grid;
		gap: 18px;
	}

	.journey-card {
		display: grid;
		gap: 12px;
		padding: 24px;
		border-radius: 22px;
		background: var(--surface-card);
		border: 1px solid var(--glass-stroke);
		box-shadow: var(--shadow-soft);
	}

	.journey-card__year {
		font-weight: 600;
		font-size: 0.94rem;
		letter-spacing: 0.08em;
		text-transform: uppercase;
		color: var(--text-muted);
	}

	.journey-card__summary {
		margin: 0;
		color: var(--text-muted);
	}

	.journey-card__topics {
		margin: 0;
		padding-left: 1.1rem;
		display: grid;
		gap: 6px;
		color: var(--text-muted);
	}

	.journey-card__cta,
	.journey-card__placeholder {
		display: inline-flex;
		align-items: center;
		gap: 8px;
		font-weight: 600;
		color: var(--accent);
	}

	.journey-card__placeholder {
		color: var(--text-muted);
	}

	@media (max-width: 768px) {
		.journey-hero {
			padding: 28px;
		}

		.journey-card {
			padding: 20px;
		}
	}
</style>
